import{t as _,R as D,u as N}from"./firestore.0b02de5c.js";import{j as w,a as s,r as h,b as y,c as b,s as x,u as P,g as R,d as I}from"./index.90289996.js";const C="_container_h197q_1",j="_image_h197q_31",v={container:C,delete:"_delete_h197q_11",image:j};function k({imgSrc:l,imgName:i,deleteImage:r}){return w("div",{className:v.container,children:[s("span",{className:v.delete,onClick:()=>r(i),children:"Delete"}),s("img",{className:v.image,src:l})]})}var S=(l,i,r)=>new Promise((d,c)=>{var p=n=>{try{u(r.next(n))}catch(m){c(m)}},f=n=>{try{u(r.throw(n))}catch(m){c(m)}},u=n=>n.done?d(n.value):Promise.resolve(n.value).then(p,f);u((r=r.apply(l,i)).next())});function L(){const[l,i]=h.exports.useState(""),[r,d]=h.exports.useState([]),c=h.exports.useRef(null);function p(){return S(this,null,function*(){if(!y.currentUser)return;const e=[];let t=!1;if(r)for(const a of r)try{const o=b(x,`${y.currentUser.uid}/${a.name}`);yield P(o,a.raw);const g=yield R(o);e.push(g)}catch(o){console.error(o),t=!0}if(!t)try{yield _(D(I,"posts"),{uid:y.currentUser.uid,body:l,date:N.now(),images:e}),i(""),d([])}catch(a){console.error(a)}})}function f(e){e.stopPropagation(),e.preventDefault();const t=e.dataTransfer,a=t&&t.files;n(a)}function u(e){e.preventDefault();const t=e.target.files;t&&n(t)}function n(e){for(const t of e){let a;const o=new FileReader;o.onload=()=>{a=o.result,d(g=>[...g,{name:t.name,data:a,raw:t}])},o.readAsDataURL(t)}}function m(e){e.preventDefault(),console.log("object entered drop zone")}function U(e){d(t=>t.filter(a=>a.name!==e))}return w("div",{id:"post-writer",onDragOver:m,onDrop:f,className:"writer post",children:[r.map((e,t)=>s(k,{imgSrc:e.data,imgName:e.name,deleteImage:U},t)),s("input",{type:"text",value:l,onChange:e=>i(e.target.value),className:"input",placeholder:"What's on your mind?"}),s("input",{type:"file",ref:c,onChange:u,accept:"image/*",hidden:!0}),s("button",{className:"button primary",onClick:p,type:"button",children:"Post"}),s("button",{className:"light",type:"button",onClick:()=>c.current&&c.current.click(),children:"Add Image"})]})}export{L as default};
