import{t as N,R as b,u as v}from"./firestore.0b02de5c.js";import{j as g,a as n,r as u,b as m,c as _,s as x,u as R,g as I,d as C}from"./index.e531dfa1.js";const P="_container_h197q_1",j="_image_h197q_31",p={container:P,delete:"_delete_h197q_11",image:j};function k({imgSrc:s,imgName:i,deleteImage:o}){return g("div",{className:p.container,children:[n("span",{className:p.delete,onClick:()=>o(i),children:"Delete"}),n("img",{className:p.image,src:s})]})}function A(){const[s,i]=u.exports.useState(""),[o,l]=u.exports.useState([]),c=u.exports.useRef(null);async function h(){if(!m.currentUser)return;const e=[];let t=!1;if(o)for(const a of o)try{const r=_(x,`${m.currentUser.uid}/${a.name}`);await R(r,a.raw);const d=await I(r);e.push(d)}catch(r){console.error(r),t=!0}if(!t)try{await N(b(C,"posts"),{uid:m.currentUser.uid,body:s,date:v.now(),images:e}),i(""),l([])}catch(a){console.error(a)}}function w(e){e.stopPropagation(),e.preventDefault();const t=e.dataTransfer,a=t&&t.files;f(a)}function y(e){e.preventDefault();const t=e.target.files;t&&f(t)}function f(e){for(const t of e){let a;const r=new FileReader;r.onload=()=>{a=r.result,l(d=>[...d,{name:t.name,data:a,raw:t}])},r.readAsDataURL(t)}}function U(e){e.preventDefault(),console.log("object entered drop zone")}function D(e){l(t=>t.filter(a=>a.name!==e))}return g("div",{id:"post-writer",onDragOver:U,onDrop:w,className:"writer post",children:[o.map((e,t)=>n(k,{imgSrc:e.data,imgName:e.name,deleteImage:D},t)),n("input",{type:"text",value:s,onChange:e=>i(e.target.value),className:"input",placeholder:"What's on your mind?"}),n("input",{type:"file",ref:c,onChange:y,accept:"image/*",hidden:!0}),n("button",{className:"button primary",onClick:h,type:"button",children:"Post"}),n("button",{className:"light",type:"button",onClick:()=>c.current&&c.current.click(),children:"Add Image"})]})}export{A as default};
