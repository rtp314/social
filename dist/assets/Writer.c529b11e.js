import{j as f,a as n,r as p,b as d,c as D,s as N,u as v,g as _,d as b,w as x,e as I,f as C}from"./index.88d996d1.js";const P="_container_h197q_1",k="_image_h197q_31",u={container:P,delete:"_delete_h197q_11",image:k};function R({imgSrc:o,imgName:i,deleteImage:s}){return f("div",{className:u.container,children:[n("span",{className:u.delete,onClick:()=>s(i),children:"Delete"}),n("img",{className:u.image,src:o})]})}function j(){const[o,i]=p.exports.useState(""),[s,l]=p.exports.useState([]);async function g(){if(!d.currentUser)return;const e=[];let t=!1;if(s)for(const a of s)try{const r=D(N,`${d.currentUser.uid}/${a.name}`);await v(r,a.raw);const c=await _(r);e.push(c)}catch(r){console.error(r),t=!0}if(!t)try{await b(x(I,"posts"),{uid:d.currentUser.uid,body:o,date:C.now(),images:e}),i(""),l([])}catch(a){console.error(a)}}function h(e){e.stopPropagation(),e.preventDefault();const t=e.dataTransfer,a=t&&t.files;m(a)}function w(e){e.preventDefault();const t=e.target.files;t&&m(t)}function m(e){for(const t of e){let a;const r=new FileReader;r.onload=()=>{a=r.result,l(c=>[...c,{name:t.name,data:a,raw:t}])},r.readAsDataURL(t)}}function y(e){e.preventDefault()}function U(e){l(t=>t.filter(a=>a.name!==e))}return f("div",{id:"post-writer",onDragOver:y,onDrop:h,className:"writer post",children:[s.map((e,t)=>n(R,{imgSrc:e.data,imgName:e.name,deleteImage:U},t)),n("input",{type:"text",value:o,onChange:e=>i(e.target.value),className:"input",placeholder:"What's on your mind?"}),n("input",{type:"file",onChange:w,accept:"image/*",hidden:!0}),n("button",{className:"button primary",onClick:g,type:"button",children:"Post"}),n("button",{className:"light",type:"button",onClick:()=>fileUpload.current&&fileUpload.current.click(),children:"Add Image"})]})}export{j as default};
