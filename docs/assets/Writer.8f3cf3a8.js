import{Q as N,T as b,y as v}from"./firestore.464e6c78.js";import{j as g,a as r,r as u,b as m,c as _,s as x,u as I,g as C,d as P}from"./index.644dba97.js";const R="_container_18z3n_1",j="_image_18z3n_16",p={container:R,delete:"_delete_18z3n_6",image:j};function k({imgSrc:s,imgName:i,deleteImage:o}){return g("div",{className:p.container,children:[r("span",{className:p.delete,onClick:()=>o(i),children:"Delete"}),r("img",{className:p.image,src:s})]})}function T(){const[s,i]=u.exports.useState(""),[o,l]=u.exports.useState([]),c=u.exports.useRef(null);async function h(){if(!m.currentUser)return;const e=[];let t=!1;if(o)for(const a of o)try{const n=_(x,`${m.currentUser.uid}/${a.name}`);await I(n,a.raw);const d=await C(n);e.push(d)}catch(n){console.error(n),t=!0}if(!t)try{await N(b(P,"posts"),{uid:m.currentUser.uid,body:s,date:v.now(),images:e}),i(""),l([])}catch(a){console.error(a)}}function y(e){e.stopPropagation(),e.preventDefault();const t=e.dataTransfer,a=t&&t.files;f(a)}function w(e){e.preventDefault();const t=e.target.files;t&&f(t)}function f(e){for(const t of e){let a;const n=new FileReader;n.onload=()=>{a=n.result,l(d=>[...d,{name:t.name,data:a,raw:t}])},n.readAsDataURL(t)}}function U(e){e.preventDefault(),console.log("object entered drop zone")}function D(e){l(t=>t.filter(a=>a.name!==e))}return g("div",{id:"post-writer",onDragOver:U,onDrop:y,className:"writer post",children:[o.map((e,t)=>r(k,{imgSrc:e.data,imgName:e.name,deleteImage:D},t)),r("input",{type:"text",value:s,onChange:e=>i(e.target.value),className:"input",placeholder:"What's on your mind?"}),r("input",{type:"file",ref:c,onChange:w,accept:"image/*",hidden:!0}),r("button",{className:"button primary",onClick:h,type:"button",children:"Post"}),r("button",{className:"light",type:"button",onClick:()=>c.current&&c.current.click(),children:"Add Image"})]})}export{T as default};
